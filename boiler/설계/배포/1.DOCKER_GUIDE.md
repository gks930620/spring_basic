# ğŸ³ Docker ë°°í¬ ê°€ì´ë“œ - Doll Gacha í”„ë¡œì íŠ¸
## ğŸ“‹ ëª©ì°¨
1. [Dockerë€?](#1-dockerë€)
2. [ìƒì„±ëœ íŒŒì¼ ì„¤ëª…](#2-ìƒì„±ëœ-íŒŒì¼-ì„¤ëª…)
3. [ì‘ì—… ìˆœì„œ ë° ëª…ë ¹ì–´](#3-ì‘ì—…-ìˆœì„œ-ë°-ëª…ë ¹ì–´)
4. [ìì£¼ ì‚¬ìš©í•˜ëŠ” Docker ëª…ë ¹ì–´](#4-ìì£¼-ì‚¬ìš©í•˜ëŠ”-docker-ëª…ë ¹ì–´)
5. [íŠ¸ëŸ¬ë¸”ìŠˆíŒ…](#5-íŠ¸ëŸ¬ë¸”ìŠˆíŒ…)
---

## 1. Dockerë€?
### ğŸ¤” Dockerê°€ ë­”ê°€ìš”?
DockerëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ **ì»¨í…Œì´ë„ˆ**ë¼ëŠ” ê²©ë¦¬ëœ í™˜ê²½ì—ì„œ ì‹¤í–‰í•˜ê²Œ í•´ì£¼ëŠ” ë„êµ¬ì…ë‹ˆë‹¤.
### ì™œ Dockerë¥¼ ì‚¬ìš©í•˜ë‚˜ìš”?
- **"ë‚´ ì»´í“¨í„°ì—ì„œëŠ” ë˜ëŠ”ë°..."** ë¬¸ì œ í•´ê²° â†’ ì–´ë””ì„œë“  ë™ì¼í•œ í™˜ê²½
- **ì„¤ì¹˜ ê°„í¸** â†’ Java, DB ë“±ì„ ì¼ì¼ì´ ì„¤ì¹˜í•  í•„ìš” ì—†ìŒ
- **ë°°í¬ ì‰¬ì›€** â†’ ì´ë¯¸ì§€ë§Œ ìˆìœ¼ë©´ ì–´ë””ì„œë“  ì‹¤í–‰ ê°€ëŠ¥

### í•µì‹¬ ê°œë…
| ìš©ì–´ | ì„¤ëª… | ë¹„ìœ  |
|------|------|------|
| **Image (ì´ë¯¸ì§€)** | ì‹¤í–‰ì— í•„ìš”í•œ ëª¨ë“  ê²ƒì´ ë‹´ê¸´ í…œí”Œë¦¿ | ë¶•ì–´ë¹µ í‹€ |
| **Container (ì»¨í…Œì´ë„ˆ)** | ì´ë¯¸ì§€ë¥¼ ì‹¤í–‰í•œ ì¸ìŠ¤í„´ìŠ¤ | ë¶•ì–´ë¹µ |
| **Dockerfile** | ì´ë¯¸ì§€ë¥¼ ë§Œë“œëŠ” ë ˆì‹œí”¼ | ë¶•ì–´ë¹µ ë ˆì‹œí”¼ |
| **docker-compose** | ì—¬ëŸ¬ ì»¨í…Œì´ë„ˆë¥¼ í•œë²ˆì— ê´€ë¦¬ | ì„¸íŠ¸ ë©”ë‰´ ì£¼ë¬¸ì„œ |

---

## 2. ìƒì„±ëœ íŒŒì¼ ì„¤ëª…

### ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
```
doll_gacha/
â”œâ”€â”€ Dockerfile              â† ì•± ì´ë¯¸ì§€ ë¹Œë“œ ë ˆì‹œí”¼
â”œâ”€â”€ docker-compose.yml      â† ì „ì²´ ì„œë¹„ìŠ¤ êµ¬ì„±
â”œâ”€â”€ .dockerignore           â† Docker ë¹Œë“œ ì‹œ ì œì™¸í•  íŒŒì¼
â”œâ”€â”€ .env                    â† ì‹¤ì œ í™˜ê²½ë³€ìˆ˜ (ë¹„ë°€!)
â”œâ”€â”€ settings.gradle         â† Gradle í”„ë¡œì íŠ¸ ì„¤ì •
â””â”€â”€ src/main/resources/
    â”œâ”€â”€ application.yml     â† ê°œë°œìš© ì„¤ì •
    â””â”€â”€ application-prod.yml â† í”„ë¡œë•ì…˜ìš© ì„¤ì •
```
---
### ğŸ“„ Dockerfile - ì´ë¯¸ì§€ ë¹Œë“œ ë ˆì‹œí”¼
```dockerfile
# ===== Stage 1: ë¹Œë“œ ìŠ¤í…Œì´ì§€ =====
FROM gradle:8-jdk17 AS builder
# â†’ Gradle + JDK 17ì´ ì„¤ì¹˜ëœ ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì‹œì‘
# â†’ "builder"ë¼ëŠ” ì´ë¦„ì„ ë¶™ì—¬ì„œ ë‚˜ì¤‘ì— ì°¸ì¡°

WORKDIR /build
# â†’ ì‘ì—… ë””ë ‰í† ë¦¬ë¥¼ /buildë¡œ ì„¤ì •

COPY ../../build.gradle settings.gradle ./
COPY ../../gradle ./gradle
# â†’ Gradle ì„¤ì • íŒŒì¼ë“¤ì„ ë¨¼ì € ë³µì‚¬ (ìºì‹± í™œìš©)

RUN gradle dependencies --no-daemon || true
# â†’ ì˜ì¡´ì„± ë‹¤ìš´ë¡œë“œ (ë³€ê²½ ì—†ìœ¼ë©´ ìºì‹œ ì‚¬ìš©)

COPY ../../src ./src
# â†’ ì†ŒìŠ¤ì½”ë“œ ë³µì‚¬

RUN gradle bootJar --no-daemon -x test
# â†’ JAR íŒŒì¼ ë¹Œë“œ (í…ŒìŠ¤íŠ¸ ìŠ¤í‚µ)

# ===== Stage 2: ì‹¤í–‰ ìŠ¤í…Œì´ì§€ =====
FROM eclipse-temurin:17-jre-alpine
# â†’ ê°€ë²¼ìš´ JRE ì´ë¯¸ì§€ ì‚¬ìš© (ì•½ 200MB vs ì „ì²´ JDK 800MB)

WORKDIR /app

ENV TZ=Asia/Seoul
RUN apk add --no-cache tzdata curl && \
    cp /usr/share/zoneinfo/$TZ /etc/localtime
# â†’ ì‹œê°„ëŒ€ ì„¤ì • + curl ì„¤ì¹˜ (í—¬ìŠ¤ì²´í¬ìš©)

RUN mkdir -p /app/uploads
# â†’ ì—…ë¡œë“œ ë””ë ‰í† ë¦¬ ìƒì„±

COPY --from=builder /build/build/libs/*.jar app.jar
# â†’ builder ìŠ¤í…Œì´ì§€ì—ì„œ ë¹Œë“œí•œ JARë§Œ ê°€ì ¸ì˜´

EXPOSE 8080
# â†’ 8080 í¬íŠ¸ ì‚¬ìš©í•œë‹¤ê³  ë¬¸ì„œí™” (ì‹¤ì œ ì—´ë¦¬ëŠ” ê±´ ì•„ë‹˜)

HEALTHCHECK --interval=30s --timeout=3s --start-period=60s --retries=3 \
  CMD curl -f http://localhost:8080/actuator/health || exit 1
# â†’ 30ì´ˆë§ˆë‹¤ í—¬ìŠ¤ì²´í¬, ì‹¤íŒ¨í•˜ë©´ ì»¨í…Œì´ë„ˆ ì¬ì‹œì‘

ENTRYPOINT ["java", "-jar", "-Dspring.profiles.active=prod", "app.jar"]
# â†’ ì»¨í…Œì´ë„ˆ ì‹œì‘ ì‹œ ì‹¤í–‰í•  ëª…ë ¹ (í”„ë¡œë•ì…˜ í”„ë¡œíŒŒì¼ë¡œ ì‹¤í–‰)
```

**ğŸ’¡ ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œë€?**
- Stage 1ì—ì„œ ë¹Œë“œí•˜ê³ , Stage 2ì—ì„œëŠ” ê²°ê³¼ë¬¼(JAR)ë§Œ ê°€ì ¸ê°
- ìµœì¢… ì´ë¯¸ì§€ì— Gradle, ì†ŒìŠ¤ì½”ë“œ ë“± ë¶ˆí•„ìš”í•œ ê²ƒì´ í¬í•¨ë˜ì§€ ì•ŠìŒ
- ì´ë¯¸ì§€ í¬ê¸° ëŒ€í­ ê°ì†Œ (1GB â†’ 200MB)

---




### ğŸ“„ docker-compose.yml - ì„œë¹„ìŠ¤ êµ¬ì„±
```yaml
services:
  # ===== MariaDB ë°ì´í„°ë² ì´ìŠ¤ =====
  db:
    image: mariadb:10.11           # MariaDB ê³µì‹ ì´ë¯¸ì§€ ì‚¬ìš©
    container_name: doll_gacha_db  # ì»¨í…Œì´ë„ˆ ì´ë¦„ ì§€ì •
    restart: unless-stopped        # ìˆ˜ë™ ì¤‘ì§€ ì „ê¹Œì§€ ìë™ ì¬ì‹œì‘
    environment:                   # í™˜ê²½ë³€ìˆ˜ ì„¤ì •
      MYSQL_ROOT_PASSWORD: ${DB_ROOT_PASSWORD:-rootpassword}
      MYSQL_DATABASE: doll_gacha   # ìë™ìœ¼ë¡œ ìƒì„±í•  DB
      MYSQL_USER: doll_gacha       # ìƒì„±í•  ì‚¬ìš©ì
      MYSQL_PASSWORD: ${DB_PASSWORD:-ckdlsk13!}
      TZ: Asia/Seoul
    ports:
      - "3407:3306"                # í˜¸ìŠ¤íŠ¸:ì»¨í…Œì´ë„ˆ í¬íŠ¸ ë§¤í•‘
    volumes:
      - db_data:/var/lib/mysql     # ë°ì´í„° ì˜êµ¬ ì €ì¥
    networks:
      - doll_gacha_network         # ê°™ì€ ë„¤íŠ¸ì›Œí¬ì— ì—°ê²°
    healthcheck:                   # DB ì¤€ë¹„ ìƒíƒœ í™•ì¸
      test: ["CMD", "healthcheck.sh", "--connect", "--innodb_initialized"]
      interval: 10s
      timeout: 5s
      retries: 5

  # ===== Spring Boot ì• í”Œë¦¬ì¼€ì´ì…˜ =====
  app:
    build:
      context: .                   # í˜„ì¬ ë””ë ‰í† ë¦¬ì˜ Dockerfile ì‚¬ìš©
      dockerfile: Dockerfile
    container_name: doll_gacha_app
    restart: unless-stopped
    ports:
      - "8080:8080"                # ì›¹ ì ‘ì† í¬íŠ¸
    environment:
      # DB ì—°ê²° (dbëŠ” ì»¨í…Œì´ë„ˆ ì´ë¦„, ë‚´ë¶€ ë„¤íŠ¸ì›Œí¬ë¡œ ì—°ê²°)
      SPRING_DATASOURCE_URL: jdbc:mariadb://db:3306/doll_gacha
      SPRING_DATASOURCE_USERNAME: doll_gacha
      SPRING_DATASOURCE_PASSWORD: ${DB_PASSWORD:-ckdlsk13!}
      
      # OAuth2, JWT ë“± ë¯¼ê°í•œ ì •ë³´ëŠ” .envì—ì„œ ê°€ì ¸ì˜´
      KAKAO_CLIENT_ID: ${KAKAO_CLIENT_ID}
      KAKAO_CLIENT_SECRET: ${KAKAO_CLIENT_SECRET}
      GOOGLE_CLIENT_ID: ${GOOGLE_CLIENT_ID}
      GOOGLE_CLIENT_SECRET: ${GOOGLE_CLIENT_SECRET}
      JWT_SECRET_KEY: ${JWT_SECRET_KEY}
      APP_BASE_URL: ${APP_BASE_URL:-http://localhost:8080}
    volumes:
      - ./uploads:/app/uploads     # ì—…ë¡œë“œ íŒŒì¼ ì˜êµ¬ ì €ì¥
    depends_on:
      db:
        condition: service_healthy # DBê°€ ì¤€ë¹„ëœ í›„ì— ì•± ì‹œì‘
    networks:
      - doll_gacha_network

networks:
  doll_gacha_network:
    driver: bridge                 # ê¸°ë³¸ ë„¤íŠ¸ì›Œí¬ ë“œë¼ì´ë²„

volumes:
  db_data:                         # ì´ë¦„ ìˆëŠ” ë³¼ë¥¨ (Dockerê°€ ê´€ë¦¬)
```



**ğŸ’¡ ì£¼ìš” ê°œë…**
- `${ë³€ìˆ˜:-ê¸°ë³¸ê°’}`: í™˜ê²½ë³€ìˆ˜ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
- `depends_on`: ì˜ì¡´ì„± ìˆœì„œ ì§€ì • (DB ë¨¼ì € â†’ ì•± ë‚˜ì¤‘ì—)
- `volumes`: ì»¨í…Œì´ë„ˆê°€ ì‚­ì œë˜ì–´ë„ ë°ì´í„° ìœ ì§€
- `networks`: ì»¨í…Œì´ë„ˆë¼ë¦¬ í†µì‹ í•  ìˆ˜ ìˆëŠ” ê°€ìƒ ë„¤íŠ¸ì›Œí¬
---



### ğŸ“„ .dockerignore - ë¹Œë“œ ì œì™¸ íŒŒì¼
Docker ì´ë¯¸ì§€ ë¹Œë“œ ì‹œ ë¶ˆí•„ìš”í•œ íŒŒì¼ì„ ì œì™¸í•©ë‹ˆë‹¤.
`.gitignore`ì™€ ë¹„ìŠ·í•œ ì—­í• ì…ë‹ˆë‹¤.
```
build/           # ë¹Œë“œ ê²°ê³¼ë¬¼ (Dockerì—ì„œ ìƒˆë¡œ ë¹Œë“œí•¨)
.gradle/         # Gradle ìºì‹œ
.idea/           # IDE ì„¤ì •
*.iml
logs/            # ë¡œê·¸ íŒŒì¼
.git/            # Git íˆìŠ¤í† ë¦¬
doll_gacha_app/  # Flutter ì•± (ë³„ë„ ë°°í¬)
.env             # í™˜ê²½ë³€ìˆ˜ (ë³´ì•ˆ!)
```

---
### ğŸ“„ .env.example / .env - í™˜ê²½ë³€ìˆ˜
```bash
# ===== ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì • =====
DB_ROOT_PASSWORD=your_root_password_here
DB_PASSWORD=your_db_password_here

# ===== OAuth2 ì„¤ì • =====
KAKAO_CLIENT_ID=your_kakao_client_id
KAKAO_CLIENT_SECRET=your_kakao_client_secret
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret

# ===== JWT ì„¤ì • =====
JWT_SECRET_KEY=your_super_secret_jwt_key_at_least_32_characters_long

# ===== ì•± ì„¤ì • =====
APP_BASE_URL=http://localhost:8080
```

**âš ï¸ ì¤‘ìš”!**
- `.env.example`: í…œí”Œë¦¿ (Gitì— ì˜¬ë ¤ë„ ë¨)
- `.env`: ì‹¤ì œ ë¹„ë°€í‚¤ (ì ˆëŒ€ Gitì— ì˜¬ë¦¬ë©´ ì•ˆ ë¨!)

---

### ğŸ“„ application-prod.yml - í”„ë¡œë•ì…˜ ì„¤ì •
ê°œë°œ ì„¤ì •(`application.yml`)ê³¼ ë‹¤ë¥¸ ì :
| í•­ëª© | ê°œë°œ | í”„ë¡œë•ì…˜ |
|------|------|----------|
| `ddl-auto` | create (ë§¤ë²ˆ í…Œì´ë¸” ì¬ìƒì„±) | update (ë³€ê²½ë§Œ ì ìš©) |
| `sql.init.mode` | always (ì´ˆê¸° ë°ì´í„° ì‚½ì…) | never (ì‹¤í–‰ ì•ˆí•¨) |
| `show_sql` | true (SQL ë¡œê·¸ ì¶œë ¥) | false (ì„±ëŠ¥ í–¥ìƒ) |
| `thymeleaf.cache` | false (ì¦‰ì‹œ ë°˜ì˜) | true (ì„±ëŠ¥ í–¥ìƒ) |
| `devtools` | enabled | disabled |
---
### ğŸ“„ settings.gradle - Gradle í”„ë¡œì íŠ¸ ì„¤ì •
```groovy
rootProject.name = 'doll_gacha'
```
Gradle ë¹Œë“œ ì‹œ í”„ë¡œì íŠ¸ ì´ë¦„ì„ ì§€ì •í•©ë‹ˆë‹¤.
Docker ë©€í‹°ìŠ¤í…Œì´ì§€ ë¹Œë“œì—ì„œ í•„ìš”í•©ë‹ˆë‹¤.
---

## 3. ì‘ì—… ìˆœì„œ ë° ëª…ë ¹ì–´
### ğŸ”§ ì‚¬ì „ ì¤€ë¹„
#### Step 1: Docker Desktop ì„¤ì¹˜ í™•ì¸ - ì‚¬ì´íŠ¸ì—ì„œ ì„¤ì¹˜í•´ì•¼ë¨ 
```powershell
# Docker ë²„ì „ í™•ì¸
docker --version
# ì˜ˆìƒ ì¶œë ¥: Docker version 24.x.x

# Docker Compose ë²„ì „ í™•ì¸
docker-compose --version
# ì˜ˆìƒ ì¶œë ¥: Docker Compose version v2.x.x
```

#### Step 2: Docker Desktop ì‹¤í–‰
Windowsì—ì„œ Docker Desktop ì•±ì„ ì‹¤í–‰í•˜ê³  
ìš°ì¸¡ í•˜ë‹¨ íŠ¸ë ˆì´ì—ì„œ ğŸ³ ì•„ì´ì½˜ì´ "Docker Desktop is running" ìƒíƒœì¸ì§€ í™•ì¸

---

### ğŸš€ ë°°í¬ ì‹¤í–‰

#### Step 3: í”„ë¡œì íŠ¸ í´ë”ë¡œ ì´ë™
```powershell
cd C:\workspace\simple_side\doll_gacha
```

#### Step 4: í™˜ê²½ë³€ìˆ˜ íŒŒì¼ ìƒì„±
```powershell
# í…œí”Œë¦¿ ë³µì‚¬
Copy-Item .env.example .env

# .env íŒŒì¼ í¸ì§‘ (ë©”ëª¨ì¥ìœ¼ë¡œ ì—´ê¸°)
notepad .env
```

**.env íŒŒì¼ ìˆ˜ì • ì˜ˆì‹œ:**
```
DB_ROOT_PASSWORD=mySecureRootPass123!
DB_PASSWORD=ckdlsk13!
KAKAO_CLIENT_ID=abc123...
KAKAO_CLIENT_SECRET=def456...
GOOGLE_CLIENT_ID=ghi789...
GOOGLE_CLIENT_SECRET=jkl012...
JWT_SECRET_KEY=mySuperSecretJWTKeyThatIsAtLeast32CharactersLong
APP_BASE_URL=http://localhost:8080
```


5,6,7 ìš”ì•½
  ì´ë¯¸ì§€ ì¬ë¹Œë“œ (ì½”ë“œ ë³€ê²½ ë°˜ì˜)
docker-compose build --no-cache
  ê¸°ì¡´ ì»¨í…Œì´ë„ˆ ì¤‘ì§€ ë° ìƒˆë¡œ ì‹œì‘
docker-compose down
docker-compose up -d
#### Step 5: Docker ì´ë¯¸ì§€ ë¹Œë“œ
```powershell
# ì´ë¯¸ì§€ ë¹Œë“œ (ì²˜ìŒì—ëŠ” 5-10ë¶„ ì†Œìš”)
docker-compose build

# ë¹Œë“œ ê³¼ì • ìƒì„¸ ë³´ê¸°
docker-compose build --progress=plain
```
**ì´ ëª…ë ¹ì´ í•˜ëŠ” ì¼:**
1. Dockerfile ì½ê¸°
2. Gradle ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ (ì²˜ìŒë§Œ)
3. ì˜ì¡´ì„± ë‹¤ìš´ë¡œë“œ
4. JAR íŒŒì¼ ë¹Œë“œ
5. ìµœì¢… ì‹¤í–‰ ì´ë¯¸ì§€ ìƒì„±

#### Step 6: ì»¨í…Œì´ë„ˆ ì‹¤í–‰
```powershell
# ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰ (-d = detached)
docker-compose up -d
```

**ì´ ëª…ë ¹ì´ í•˜ëŠ” ì¼:**
1. MariaDB ì»¨í…Œì´ë„ˆ ì‹œì‘
2. DB í—¬ìŠ¤ì²´í¬ ëŒ€ê¸° (ì•½ 30ì´ˆ)
3. Spring Boot ì•± ì»¨í…Œì´ë„ˆ ì‹œì‘
4. ì•± ì‹œì‘ ì™„ë£Œ (ì•½ 30-60ì´ˆ)

#### Step 7: ì‹¤í–‰ ìƒíƒœ í™•ì¸
```powershell
# ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose ps

# ì˜ˆìƒ ì¶œë ¥:
# NAME              STATUS                   PORTS
# doll_gacha_app    Up 2 minutes (healthy)   0.0.0.0:8080->8080/tcp
# doll_gacha_db     Up 2 minutes (healthy)   0.0.0.0:3407->3306/tcp
```

#### Step 8: ë¡œê·¸ í™•ì¸
```powershell
# ì „ì²´ ë¡œê·¸ ë³´ê¸°
docker-compose logs

# ì‹¤ì‹œê°„ ë¡œê·¸ ë³´ê¸° (Ctrl+Cë¡œ ì¢…ë£Œ)
docker-compose logs -f

# ì•± ë¡œê·¸ë§Œ ë³´ê¸°
docker-compose logs -f app

# DB ë¡œê·¸ë§Œ ë³´ê¸°
docker-compose logs -f db
```

#### Step 9: ì ‘ì† í…ŒìŠ¤íŠ¸
```powershell
# ë¸Œë¼ìš°ì €ì—ì„œ ì—´ê¸°
Start-Process "http://localhost:8080"

# ë˜ëŠ” curlë¡œ í…ŒìŠ¤íŠ¸
curl http://localhost:8080/actuator/health
```

---

### ğŸ›‘ ì„œë¹„ìŠ¤ ì¤‘ì§€/ì‚­ì œ

#### ì„œë¹„ìŠ¤ ì¤‘ì§€ (ë°ì´í„° ìœ ì§€)
```powershell
docker-compose stop
```

#### ì„œë¹„ìŠ¤ ì¬ì‹œì‘
```powershell
docker-compose start
```

#### ì»¨í…Œì´ë„ˆ ì‚­ì œ (ë°ì´í„° ìœ ì§€)
```powershell
docker-compose down
```

#### ì™„ì „ ì‚­ì œ (ë°ì´í„° í¬í•¨)
```powershell
# ë³¼ë¥¨(DB ë°ì´í„°)ê¹Œì§€ ì‚­ì œ
docker-compose down -v

# ì´ë¯¸ì§€ê¹Œì§€ ì‚­ì œ
docker-compose down -v --rmi all
```

---

### ğŸ”„ ì—…ë°ì´íŠ¸ ë°°í¬

ì½”ë“œ ìˆ˜ì • í›„ ì¬ë°°í¬:
```powershell
# 1. ìƒˆë¡œ ë¹Œë“œí•˜ë©´ì„œ ì‹¤í–‰
docker-compose up -d --build

# ë˜ëŠ” ë‹¨ê³„ë³„ë¡œ:
# 1. ì»¨í…Œì´ë„ˆ ì¤‘ì§€
docker-compose down

# 2. ìƒˆë¡œ ë¹Œë“œ
docker-compose build

# 3. ë‹¤ì‹œ ì‹¤í–‰
docker-compose up -d
```

---

## 4. ìì£¼ ì‚¬ìš©í•˜ëŠ” Docker ëª…ë ¹ì–´

### ğŸ“Š ìƒíƒœ í™•ì¸
```powershell
# ì‹¤í–‰ ì¤‘ì¸ ì»¨í…Œì´ë„ˆ ëª©ë¡
docker ps

# ëª¨ë“  ì»¨í…Œì´ë„ˆ (ì¤‘ì§€ëœ ê²ƒ í¬í•¨)
docker ps -a

# ì´ë¯¸ì§€ ëª©ë¡
docker images

# ë””ìŠ¤í¬ ì‚¬ìš©ëŸ‰
docker system df
```

### ğŸ” ë””ë²„ê¹…
```powershell
# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ ì ‘ì† (bash)
docker exec -it doll_gacha_app sh

# ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œ ëª…ë ¹ ì‹¤í–‰
docker exec doll_gacha_app ls -la /app

# DB ì»¨í…Œì´ë„ˆ ì ‘ì†
docker exec -it doll_gacha_db mysql -u doll_gacha -p
```

### ğŸ§¹ ì •ë¦¬
```powershell
# ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ ì •ë¦¬
docker system prune

# ëª¨ë“  ë¯¸ì‚¬ìš© ì´ë¯¸ì§€ ì‚­ì œ
docker image prune -a

# ëª¨ë“  ë³¼ë¥¨ ì‚­ì œ (ì£¼ì˜!)
docker volume prune
```

---

## 5. íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### âŒ "port is already allocated"
```powershell
# í¬íŠ¸ ì‚¬ìš© ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸
netstat -ano | findstr :8080

# í•´ë‹¹ í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œ (PID í™•ì¸ í›„)
taskkill /PID <PIDë²ˆí˜¸> /F

# ë˜ëŠ” docker-compose.ymlì—ì„œ í¬íŠ¸ ë³€ê²½
# ports:
#   - "8081:8080"  â† 8081ë¡œ ë³€ê²½
```

### âŒ "Cannot connect to the Docker daemon"
```powershell
# Docker Desktopì´ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸
# ì‹œìŠ¤í…œ íŠ¸ë ˆì´ì—ì„œ Docker ì•„ì´ì½˜ í™•ì¸

# Docker Desktop ì¬ì‹œì‘
# ë˜ëŠ” ì„œë¹„ìŠ¤ ì¬ì‹œì‘
Restart-Service docker
```

### âŒ "database connection failed"
```powershell
# DB ì»¨í…Œì´ë„ˆ ìƒíƒœ í™•ì¸
docker-compose logs db

# DBê°€ ì™„ì „íˆ ì‹œì‘ë  ë•Œê¹Œì§€ ëŒ€ê¸° (ì²˜ìŒ ì‹¤í–‰ ì‹œ 1-2ë¶„)
docker-compose logs -f db

# ì•±ë§Œ ì¬ì‹œì‘
docker-compose restart app
```

### âŒ ì´ë¯¸ì§€ ë¹Œë“œ ì‹¤íŒ¨
```powershell
# ìºì‹œ ì—†ì´ ìƒˆë¡œ ë¹Œë“œ
docker-compose build --no-cache

# ë¹Œë“œ ë¡œê·¸ ìƒì„¸ í™•ì¸
docker-compose build --progress=plain 2>&1 | Tee-Object build.log
```

### âŒ ë©”ëª¨ë¦¬ ë¶€ì¡±
Docker Desktop ì„¤ì •ì—ì„œ ë©”ëª¨ë¦¬ í• ë‹¹ ëŠ˜ë¦¬ê¸°:
1. Docker Desktop â†’ Settings â†’ Resources
2. Memoryë¥¼ 4GB ì´ìƒìœ¼ë¡œ ì„¤ì •
3. Apply & Restart

---

## ğŸ“š ì°¸ê³  ìë£Œ

- [Docker ê³µì‹ ë¬¸ì„œ](https://docs.docker.com/)
- [Docker Compose ê³µì‹ ë¬¸ì„œ](https://docs.docker.com/compose/)
- [Spring Boot Docker ê°€ì´ë“œ](https://spring.io/guides/topicals/spring-boot-docker/)

---

## âœ… ì²´í¬ë¦¬ìŠ¤íŠ¸

ë°°í¬ ì „ í™•ì¸ì‚¬í•­:
- [ ] Docker Desktop ì‹¤í–‰ ì¤‘
- [ ] `.env` íŒŒì¼ì— ëª¨ë“  í™˜ê²½ë³€ìˆ˜ ì„¤ì •
- [ ] 8080 í¬íŠ¸ ì‚¬ìš© ê°€ëŠ¥
- [ ] 3407 í¬íŠ¸ ì‚¬ìš© ê°€ëŠ¥ (DB)

ë°°í¬ í›„ í™•ì¸ì‚¬í•­:
- [ ] `docker-compose ps`ì—ì„œ ëª¨ë“  ì„œë¹„ìŠ¤ healthy
- [ ] http://localhost:8080 ì ‘ì† ê°€ëŠ¥
- [ ] ë¡œê·¸ì¸ ê¸°ëŠ¥ ì •ìƒ ì‘ë™
- [ ] íŒŒì¼ ì—…ë¡œë“œ ì •ìƒ ì‘ë™

---

*ë¬¸ì„œ ì‘ì„±ì¼: 2026-01-20*
*í”„ë¡œì íŠ¸: Doll Gacha*

